<h1 id="code-smells-and-refactoring-in-kotlin">Code Smells and
Refactoring in Kotlin</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#learning-outcomes">Learning Outcomes</a></li>
<li><a href="#introduction-to-code-smells-and-refactoring">Introduction
to Code Smells and Refactoring</a></li>
<li><a href="#common-code-smells">Common Code Smells</a>
<ul>
<li><a href="#duplicated-code">Duplicated Code</a></li>
<li><a href="#long-method">Long Method</a></li>
<li><a href="#large-class">Large Class</a></li>
<li><a href="#long-parameter-list">Long Parameter List</a></li>
<li><a href="#temporary-field">Temporary Field</a></li>
<li><a href="#data-class">Data Class</a></li>
</ul></li>
<li><a href="#refactoring-techniques-composing-methods">Refactoring
Techniques: Composing Methods</a>
<ul>
<li><a href="#extract-method">Extract Method</a></li>
<li><a href="#introduce-explaining-variable">Introduce Explaining
Variable</a></li>
<li><a href="#inline-method">Inline Method</a></li>
<li><a href="#inline-temp">Inline Temp</a></li>
</ul></li>
<li><a href="#refactoring-techniques-organizing-data">Refactoring
Techniques: Organizing Data</a>
<ul>
<li><a href="#encapsulate-field">Encapsulate Field</a></li>
<li><a href="#encapsulate-collection">Encapsulate Collection</a></li>
<li><a href="#replace-type-code-with-class">Replace Type Code with
Class</a></li>
</ul></li>
<li><a
href="#refactoring-techniques-making-method-calls-simpler">Refactoring
Techniques: Making Method Calls Simpler</a>
<ul>
<li><a href="#remove-setting-method">Remove Setting Method</a></li>
<li><a href="#hide-method">Hide Method</a></li>
<li><a href="#rename-method">Rename Method</a></li>
<li><a href="#add-parameter-and-remove-parameter">Add Parameter and
Remove Parameter</a></li>
</ul></li>
<li><a href="#unit-testing-and-refactoring">Unit Testing and
Refactoring</a></li>
<li><a href="#summary-and-best-practices">Summary and Best
Practices</a></li>
</ul>
<hr />
<h2 id="learning-outcomes">Learning Outcomes</h2>
<p>By the end of this lecture, you will be able to:</p>
<ol type="1">
<li>Define what code smells are and explain why they matter in software
development</li>
<li>Identify common code smells in Kotlin code including duplicated
code, long methods, large classes, long parameter lists, temporary
fields, and data classes</li>
<li>Understand the concept of refactoring and its role in improving code
quality without changing external behavior</li>
<li>Apply specific refactoring techniques to eliminate code smells in
Kotlin programs</li>
<li>Recognize when to use extract method, inline method, encapsulation,
and other refactoring patterns</li>
<li>Understand the relationship between unit testing and safe
refactoring practices</li>
<li>Make informed decisions about when and how to refactor code to
improve maintainability</li>
</ol>
<hr />
<h2 id="introduction-to-code-smells-and-refactoring">Introduction to
Code Smells and Refactoring</h2>
<h3 id="what-is-a-code-smell">What is a Code Smell?</h3>
<p>A code smell is not a bug—your code still works! Instead, it’s a
warning sign that something in your code design or implementation could
be improved. Think of it like smoke: where there’s smoke, there might be
fire. Where there’s a code smell, there might be a deeper design
problem.</p>
<p>According to Fowler (2006), a code smell is “a surface indication
that usually corresponds to a deeper problem in the system.” Tufano et
al. (2015) describe them as “symptoms of poor design and implementation
choices.”</p>
<h3 id="what-is-refactoring">What is Refactoring?</h3>
<p>Refactoring is the process of improving your code’s internal
structure without changing what it does externally. Fowler (1999)
defines it as:</p>
<blockquote>
<p>“Changing a software system in such a way that it does not alter the
external behavior of the code yet improves its internal structure. It is
a disciplined way to clean up the code that minimizes the chances of
introducing bugs.”</p>
</blockquote>
<p>The key principles of refactoring: - <strong>No new
functionality</strong>: You’re not adding features, just improving
structure - <strong>Preserve behavior</strong>: Tests should still pass
after refactoring - <strong>Small steps</strong>: Make incremental
changes that can be easily verified - <strong>Continuous
improvement</strong>: Refactor as you go, not as a separate phase</p>
<h3 id="why-should-we-care">Why Should We Care?</h3>
<ul>
<li><strong>Maintainability</strong>: Clean code is easier to understand
and modify</li>
<li><strong>Bug prevention</strong>: Simple, clear code has fewer hiding
places for bugs</li>
<li><strong>Team collaboration</strong>: Other developers can work with
your code more easily</li>
<li><strong>Technical debt</strong>: Addressing smells prevents
accumulation of “debt” that slows future development</li>
</ul>
<hr />
<h2 id="common-code-smells">Common Code Smells</h2>
<h3 id="duplicated-code">Duplicated Code</h3>
<p><strong>The Problem</strong>: The same or very similar code structure
appears in multiple places. This is one of the most common and
problematic code smells.</p>
<p>Duplicated code can appear: - Within the same function - In two
different methods in the same class - In subclasses that share a parent
class</p>
<p><strong>Why It’s Bad</strong>: - If you find a bug, you have to fix
it in multiple places - If you want to change behavior, you have to
update multiple locations - Increases maintenance burden and risk of
inconsistency</p>
<p><strong>Example of Duplicated Code</strong>:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating duplicated code smell</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * The validation logic is repeated in multiple places</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> UserRegistration <span class="op">{</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Duplicated validation in register method</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">registerUser</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate username</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too short&quot;</span><span class="op">)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&gt;</span> <span class="dv">20</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too long&quot;</span><span class="op">)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate email</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>email<span class="op">.</span>contains<span class="op">(</span><span class="st">&quot;@&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Invalid email&quot;</span><span class="op">)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;User registered: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Same validation duplicated in update method</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">updateUser</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate username (DUPLICATED!)</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too short&quot;</span><span class="op">)</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&gt;</span> <span class="dv">20</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too long&quot;</span><span class="op">)</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate email (DUPLICATED!)</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>email<span class="op">.</span>contains<span class="op">(</span><span class="st">&quot;@&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Invalid email&quot;</span><span class="op">)</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;User updated: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">registration</span> <span class="op">=</span> UserRegistration<span class="op">()</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Test registration</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    registration<span class="op">.</span>registerUser<span class="op">(</span><span class="st">&quot;ab&quot;</span><span class="op">,</span> <span class="st">&quot;test@email.com&quot;</span><span class="op">,</span> <span class="st">&quot;pass123&quot;</span><span class="op">)</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    registration<span class="op">.</span>registerUser<span class="op">(</span><span class="st">&quot;validuser&quot;</span><span class="op">,</span> <span class="st">&quot;test@email.com&quot;</span><span class="op">,</span> <span class="st">&quot;pass123&quot;</span><span class="op">)</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Test update</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    registration<span class="op">.</span>updateUser<span class="op">(</span><span class="st">&quot;ab&quot;</span><span class="op">,</span> <span class="st">&quot;newemail@test.com&quot;</span><span class="op">)</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    registration<span class="op">.</span>updateUser<span class="op">(</span><span class="st">&quot;validuser&quot;</span><span class="op">,</span> <span class="st">&quot;newemail@test.com&quot;</span><span class="op">)</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>Username too short
User registered: validuser
Username too short
User updated: validuser</code></pre>
<p>Notice how the validation logic is duplicated. If we need to change
the minimum username length, we’d have to update it in two places!</p>
<hr />
<h3 id="long-method">Long Method</h3>
<p><strong>The Problem</strong>: A method that tries to do too many
things or contains too many lines of code.</p>
<p><strong>Why It’s Bad</strong>: - Harder to understand what the method
does - Difficult to test all the different paths - More likely to
contain bugs - Violates the Single Responsibility Principle</p>
<p><strong>Rule of Thumb</strong>: If you can’t see the entire method on
your screen, it’s probably too long.</p>
<p><strong>Example of Long Method</strong>:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating long method smell</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * This method does too many things: parsing, validation, calculation, and formatting</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> OrderProcessor <span class="op">{</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// This method is too long and does too many things!</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">processOrder</span><span class="op">(</span><span class="va">orderData</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Parse the order data</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">parts</span> <span class="op">=</span> orderData<span class="op">.</span>split<span class="op">(</span><span class="st">&quot;,&quot;</span><span class="op">)</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">itemName</span> <span class="op">=</span> parts<span class="op">[</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">quantity</span> <span class="op">=</span> parts<span class="op">[</span><span class="dv">1</span><span class="op">].</span>toInt<span class="op">()</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">priceStr</span> <span class="op">=</span> parts<span class="op">[</span><span class="dv">2</span><span class="op">]</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">price</span> <span class="op">=</span> priceStr<span class="op">.</span>toDouble<span class="op">()</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validate the data</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>itemName<span class="op">.</span>isEmpty<span class="op">())</span> <span class="op">{</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="st">&quot;Error: Invalid item name&quot;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>quantity <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="st">&quot;Error: Invalid quantity&quot;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>price <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="st">&quot;Error: Invalid price&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Calculate totals</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">subtotal</span> <span class="op">=</span> quantity <span class="op">*</span> price</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> <span class="va">discount</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>quantity <span class="op">&gt;</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            discount <span class="op">=</span> subtotal <span class="op">*</span> <span class="fl">0.1</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>quantity <span class="op">&gt;</span> <span class="dv">5</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>            discount <span class="op">=</span> subtotal <span class="op">*</span> <span class="fl">0.05</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">tax</span> <span class="op">=</span> <span class="op">(</span>subtotal <span class="op">-</span> discount<span class="op">)</span> <span class="op">*</span> <span class="fl">0.2</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">total</span> <span class="op">=</span> subtotal <span class="op">-</span> discount <span class="op">+</span> tax</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Format the output</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">sb</span> <span class="op">=</span> StringBuilder<span class="op">()</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Order Summary</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;=============</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Item: </span><span class="ss">$itemName</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Quantity: </span><span class="ss">$quantity</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Unit Price: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>price<span class="op">)</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Subtotal: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>subtotal<span class="op">)</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Discount: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>discount<span class="op">)</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Tax: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>tax<span class="op">)</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Total: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>total<span class="op">)</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> sb<span class="op">.</span>toString<span class="op">()</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">processor</span> <span class="op">=</span> OrderProcessor<span class="op">()</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Process an order</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">result</span> <span class="op">=</span> processor<span class="op">.</span>processOrder<span class="op">(</span><span class="st">&quot;Laptop,12,500.00&quot;</span><span class="op">)</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>result<span class="op">)</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>Order Summary
=============
Item: Laptop
Quantity: 12
Unit Price: £500.00
Subtotal: £6000.00
Discount: £600.00
Tax: £1080.00
Total: £6480.00</code></pre>
<p>This method does parsing, validation, calculation, and formatting all
in one place. It’s hard to test individual pieces and hard to understand
at a glance.</p>
<hr />
<h3 id="large-class">Large Class</h3>
<p><strong>The Problem</strong>: A class that tries to do too much and
has too many responsibilities.</p>
<p><strong>Why It’s Bad</strong>: - Violates the Single Responsibility
Principle - Hard to understand and maintain - Often has too many
instance variables - Common in GUI classes where everything gets dumped
into one place</p>
<p><strong>Example of Large Class</strong>:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating large class smell</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * This class handles user management, email, logging, and database operations</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * It should be split into multiple focused classes</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> UserManager <span class="op">{</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Too many instance variables - warning sign!</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">users</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;()</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">emails</span> <span class="op">=</span> mutableMapOf<span class="op">&lt;</span><span class="kw">String</span><span class="op">,</span> <span class="kw">String</span><span class="op">&gt;()</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">logMessages</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;()</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">var</span> <span class="va">dbConnection</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;localhost:5432&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">var</span> <span class="va">emailServer</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;smtp.example.com&quot;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">var</span> <span class="va">logFile</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;app.log&quot;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// User management responsibilities</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">addUser</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        users<span class="op">.</span>add<span class="op">(</span>username<span class="op">)</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        emails<span class="op">[</span>username<span class="op">]</span> <span class="op">=</span> email</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        log<span class="op">(</span><span class="st">&quot;User added: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        saveToDatabase<span class="op">(</span>username<span class="op">,</span> email<span class="op">)</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">removeUser</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        users<span class="op">.</span>remove<span class="op">(</span>username<span class="op">)</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        emails<span class="op">.</span>remove<span class="op">(</span>username<span class="op">)</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>        log<span class="op">(</span><span class="st">&quot;User removed: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>        deleteFromDatabase<span class="op">(</span>username<span class="op">)</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Email responsibilities</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">sendEmail</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">subject</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">body</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">email</span> <span class="op">=</span> emails<span class="op">[</span>username<span class="op">]</span> <span class="op">?:</span> <span class="kw">return</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        log<span class="op">(</span><span class="st">&quot;Sending email to </span><span class="ss">$email</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Connecting to </span><span class="ss">$emailServer</span><span class="st">...&quot;</span><span class="op">)</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Sending to: </span><span class="ss">$email</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Subject: </span><span class="ss">$subject</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Body: </span><span class="ss">$body</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Logging responsibilities</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">log</span><span class="op">(</span><span class="va">message</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">timestamp</span> <span class="op">=</span> System<span class="op">.</span>currentTimeMillis<span class="op">()</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">logEntry</span> <span class="op">=</span> <span class="st">&quot;[</span><span class="ss">$timestamp</span><span class="st">] </span><span class="ss">$message</span><span class="st">&quot;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>        logMessages<span class="op">.</span>add<span class="op">(</span>logEntry<span class="op">)</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;LOG: </span><span class="ss">$logEntry</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">printLogs</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;=== Log History ===&quot;</span><span class="op">)</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        logMessages<span class="op">.</span>forEach <span class="op">{</span> println<span class="op">(</span>it<span class="op">)</span> <span class="op">}</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Database responsibilities</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">saveToDatabase</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Connecting to database: </span><span class="ss">$dbConnection</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Saving user: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">deleteFromDatabase</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Connecting to database: </span><span class="ss">$dbConnection</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Deleting user: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Configuration responsibilities</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">setDatabaseConnection</span><span class="op">(</span><span class="va">connection</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>        dbConnection <span class="op">=</span> connection</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>        log<span class="op">(</span><span class="st">&quot;Database connection updated&quot;</span><span class="op">)</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">setEmailServer</span><span class="op">(</span><span class="va">server</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>        emailServer <span class="op">=</span> server</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>        log<span class="op">(</span><span class="st">&quot;Email server updated&quot;</span><span class="op">)</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">manager</span> <span class="op">=</span> UserManager<span class="op">()</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Using the bloated class</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>    manager<span class="op">.</span>addUser<span class="op">(</span><span class="st">&quot;alice&quot;</span><span class="op">,</span> <span class="st">&quot;alice@example.com&quot;</span><span class="op">)</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    manager<span class="op">.</span>sendEmail<span class="op">(</span><span class="st">&quot;alice&quot;</span><span class="op">,</span> <span class="st">&quot;Welcome&quot;</span><span class="op">,</span> <span class="st">&quot;Welcome to our service!&quot;</span><span class="op">)</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>    manager<span class="op">.</span>printLogs<span class="op">()</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>LOG: [1732198745123] User added: alice
Connecting to database: localhost:5432
Saving user: alice
Connecting to smtp.example.com...
Sending to: alice@example.com
Subject: Welcome
Body: Welcome to our service!
LOG: [1732198745125] Sending email to alice@example.com
=== Log History ===
[1732198745123] User added: alice
[1732198745125] Sending email to alice@example.com</code></pre>
<p>This class has at least four distinct responsibilities: user
management, email, logging, and database operations. It should be split
into separate classes.</p>
<hr />
<h3 id="long-parameter-list">Long Parameter List</h3>
<p><strong>The Problem</strong>: Passing too many parameters to a method
makes it hard to understand and use.</p>
<p><strong>Why It’s Bad</strong>: - Hard to remember the order of
parameters - Easy to pass parameters in the wrong order - Often
indicates the method is trying to do too much - May include redundant
parameters that are already instance variables</p>
<p><strong>Example of Long Parameter List</strong>:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating long parameter list smell</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * The method has too many parameters, some of which could be instance variables</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ReportGenerator <span class="op">{</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Some of these could be instance variables instead of parameters</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">generateReport</span><span class="op">(</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">title</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">author</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">date</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">department</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">category</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">priority</span><span class="op">:</span> <span class="dt">Int</span><span class="op">,</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="va">includeCharts</span><span class="op">:</span> <span class="dt">Boolean</span><span class="op">,</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">includeStatistics</span><span class="op">:</span> <span class="dt">Boolean</span><span class="op">,</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">fontSize</span><span class="op">:</span> <span class="dt">Int</span><span class="op">,</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">fontFamily</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">pageSize</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">orientation</span><span class="op">:</span> <span class="dt">String</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">):</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">report</span> <span class="op">=</span> StringBuilder<span class="op">()</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;=== </span><span class="ss">$title</span><span class="st"> ===</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Author: </span><span class="ss">$author</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Date: </span><span class="ss">$date</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Department: </span><span class="ss">$department</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Category: </span><span class="ss">$category</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Priority: </span><span class="ss">$priority</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Font: </span><span class="ss">$fontFamily</span><span class="st">, </span><span class="ss">${</span>fontSize<span class="ss">}</span><span class="st">pt</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Page: </span><span class="ss">$pageSize</span><span class="st"> (</span><span class="ss">$orientation</span><span class="st">)</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Charts: </span><span class="ss">${</span><span class="cf">if</span> <span class="op">(</span>includeCharts<span class="op">)</span> <span class="st">&quot;Yes&quot;</span> <span class="cf">else</span> <span class="st">&quot;No&quot;</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;Statistics: </span><span class="ss">${</span><span class="cf">if</span> <span class="op">(</span>includeStatistics<span class="op">)</span> <span class="st">&quot;Yes&quot;</span> <span class="cf">else</span> <span class="st">&quot;No&quot;</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>        report<span class="op">.</span>append<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">[Report content would go here]</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> report<span class="op">.</span>toString<span class="op">()</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">generator</span> <span class="op">=</span> ReportGenerator<span class="op">()</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Look at this overwhelming method call!</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">report</span> <span class="op">=</span> generator<span class="op">.</span>generateReport<span class="op">(</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Monthly Sales Report&quot;</span><span class="op">,</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;John Smith&quot;</span><span class="op">,</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;2024-11-21&quot;</span><span class="op">,</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Sales&quot;</span><span class="op">,</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Financial&quot;</span><span class="op">,</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span><span class="op">,</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>        <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>        <span class="dv">12</span><span class="op">,</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Arial&quot;</span><span class="op">,</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;A4&quot;</span><span class="op">,</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Portrait&quot;</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>report<span class="op">)</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== Monthly Sales Report ===
Author: John Smith
Date: 2024-11-21
Department: Sales
Category: Financial
Priority: 1
Font: Arial, 12pt
Page: A4 (Portrait)
Charts: Yes
Statistics: Yes

[Report content would go here]</code></pre>
<p>This method has 12 parameters! It’s error-prone and hard to use. Many
of these could be instance variables or could be grouped into
configuration objects.</p>
<hr />
<h3 id="temporary-field">Temporary Field</h3>
<p><strong>The Problem</strong>: An instance variable that is only set
or used in certain circumstances, not throughout the object’s
lifetime.</p>
<p><strong>Why It’s Bad</strong>: - Confusing because the field is
sometimes empty/null - Wastes memory when not in use - Makes the
object’s state unclear - Often indicates the field should belong to a
different class or be a local variable</p>
<p><strong>Example of Temporary Field</strong>:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating temporary field smell</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * The calculationCache field is only used during complex calculations</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * and remains null most of the time</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DataProcessor <span class="op">{</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">Int</span><span class="op">&gt;()</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// This field is only used during calculateStatistics()</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// It&#39;s null most of the time - that&#39;s the smell!</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">var</span> <span class="va">calculationCache</span><span class="op">:</span> MutableMap<span class="op">&lt;</span><span class="kw">String</span><span class="op">,</span> <span class="kw">Double</span><span class="op">&gt;?</span> <span class="op">=</span> <span class="kw">null</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">addData</span><span class="op">(</span><span class="va">value</span><span class="op">:</span> <span class="dt">Int</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">data</span><span class="op">.</span>add<span class="op">(</span>value<span class="op">)</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">calculateStatistics</span><span class="op">():</span> <span class="dt">Map</span><span class="op">&lt;</span><span class="dt">String</span>, <span class="dt">Double</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Temporary field is only set here</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        calculationCache <span class="op">=</span> mutableMapOf<span class="op">()</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">sum</span> <span class="op">=</span> <span class="kw">data</span><span class="op">.</span>sum<span class="op">().</span>toDouble<span class="op">()</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">average</span> <span class="op">=</span> sum <span class="op">/</span> <span class="kw">data</span><span class="op">.</span>size</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">max</span> <span class="op">=</span> <span class="kw">data</span><span class="op">.</span>maxOrNull<span class="op">()?.</span>toDouble<span class="op">()</span> <span class="op">?:</span> <span class="fl">0.0</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">min</span> <span class="op">=</span> <span class="kw">data</span><span class="op">.</span>minOrNull<span class="op">()?.</span>toDouble<span class="op">()</span> <span class="op">?:</span> <span class="fl">0.0</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Using the temporary field</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        calculationCache<span class="op">!![</span><span class="st">&quot;sum&quot;</span><span class="op">]</span> <span class="op">=</span> sum</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        calculationCache<span class="op">!![</span><span class="st">&quot;average&quot;</span><span class="op">]</span> <span class="op">=</span> average</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        calculationCache<span class="op">!![</span><span class="st">&quot;max&quot;</span><span class="op">]</span> <span class="op">=</span> max</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        calculationCache<span class="op">!![</span><span class="st">&quot;min&quot;</span><span class="op">]</span> <span class="op">=</span> min</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">result</span> <span class="op">=</span> calculationCache<span class="op">!!.</span>toMap<span class="op">()</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Temporary field is cleared after use</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        calculationCache <span class="op">=</span> <span class="kw">null</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> result</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">printData</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Data: </span><span class="ss">$data</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Cache status: </span><span class="ss">${</span><span class="cf">if</span> <span class="op">(</span>calculationCache <span class="op">==</span> <span class="kw">null</span><span class="op">)</span> <span class="st">&quot;Empty&quot;</span> <span class="cf">else</span> <span class="st">&quot;Active&quot;</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">processor</span> <span class="op">=</span> DataProcessor<span class="op">()</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Add some data</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    processor<span class="op">.</span>addData<span class="op">(</span><span class="dv">10</span><span class="op">)</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>    processor<span class="op">.</span>addData<span class="op">(</span><span class="dv">20</span><span class="op">)</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>    processor<span class="op">.</span>addData<span class="op">(</span><span class="dv">30</span><span class="op">)</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Before calculation:&quot;</span><span class="op">)</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    processor<span class="op">.</span>printData<span class="op">()</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Calculate statistics (this is when the temporary field is used)</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">stats</span> <span class="op">=</span> processor<span class="op">.</span>calculateStatistics<span class="op">()</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Statistics: </span><span class="ss">$stats</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">After calculation:&quot;</span><span class="op">)</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>    processor<span class="op">.</span>printData<span class="op">()</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>Before calculation:
Data: [10, 20, 30]
Cache status: Empty

Statistics: {sum=60.0, average=20.0, max=30.0, min=10.0}

After calculation:
Data: [10, 20, 30]
Cache status: Empty</code></pre>
<p>The <code>calculationCache</code> field is null most of the time and
only used during one method. This suggests it should be a local variable
or moved to a separate class.</p>
<hr />
<h3 id="data-class">Data Class</h3>
<p><strong>The Problem</strong>: Classes that only contain fields with
getters and setters, but no meaningful behavior.</p>
<p><strong>Why It’s Bad</strong>: - Violates the principle of
encapsulation - Business logic ends up scattered in other classes -
Setters might not be needed at all - Collections might be fully
modifiable from outside, breaking encapsulation</p>
<p><strong>Note</strong>: Kotlin’s <code>data class</code> keyword is
different—it’s a useful language feature. The smell refers to classes
that are just “data holders” with no behavior protection.</p>
<p><strong>Example of Data Class Smell</strong>:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating data class smell (not Kotlin&#39;s data class feature!)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * This class exposes all its data with getters and setters</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * and has no meaningful behavior or validation</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">// This is the &quot;smelly&quot; version - just getters and setters</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BankAccount <span class="op">{</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">accountNumber</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">balance</span><span class="op">:</span> <span class="kw">Double</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">accountHolder</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">isActive</span><span class="op">:</span> <span class="kw">Boolean</span> <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// No validation, no behavior, just data access</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Anyone can set balance to negative, change account number, etc.</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">// Example of misuse - business logic is outside the class</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AccountManager <span class="op">{</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">processWithdrawal</span><span class="op">(</span><span class="va">account</span><span class="op">:</span> <span class="dt">BankAccount</span><span class="op">,</span> <span class="va">amount</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Business logic is here instead of in BankAccount!</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>account<span class="op">.</span>isActive<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Account is not active&quot;</span><span class="op">)</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>account<span class="op">.</span>balance <span class="op">&lt;</span> amount<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Insufficient funds&quot;</span><span class="op">)</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        account<span class="op">.</span>balance <span class="op">-=</span> amount</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Withdrew £</span><span class="ss">$amount</span><span class="st">. New balance: £</span><span class="ss">${</span>account<span class="op">.</span>balance<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">processDeposit</span><span class="op">(</span><span class="va">account</span><span class="op">:</span> <span class="dt">BankAccount</span><span class="op">,</span> <span class="va">amount</span><span class="op">:</span> <span class="dt">Double</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">// More business logic outside the class</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>amount <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Invalid deposit amount&quot;</span><span class="op">)</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        account<span class="op">.</span>balance <span class="op">+=</span> amount</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Deposited £</span><span class="ss">$amount</span><span class="st">. New balance: £</span><span class="ss">${</span>account<span class="op">.</span>balance<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">account</span> <span class="op">=</span> BankAccount<span class="op">()</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>accountNumber <span class="op">=</span> <span class="st">&quot;12345&quot;</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>accountHolder <span class="op">=</span> <span class="st">&quot;Alice Smith&quot;</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>balance <span class="op">=</span> <span class="fl">1000.0</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">// The problem: anyone can do this!</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>balance <span class="op">=</span> <span class="op">-</span><span class="fl">500.0</span>  <span class="co">// No validation!</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Balance set to: £</span><span class="ss">${</span>account<span class="op">.</span>balance<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Business logic is scattered in other classes</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">manager</span> <span class="op">=</span> AccountManager<span class="op">()</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>balance <span class="op">=</span> <span class="fl">1000.0</span>  <span class="co">// Reset for example</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>    manager<span class="op">.</span>processWithdrawal<span class="op">(</span>account<span class="op">,</span> <span class="fl">200.0</span><span class="op">)</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>    manager<span class="op">.</span>processDeposit<span class="op">(</span>account<span class="op">,</span> <span class="fl">500.0</span><span class="op">)</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>Balance set to: £-500.0
Withdrew £200.0. New balance: £800.0
Deposited £500.0. New balance: £1300.0</code></pre>
<p>The problem here is that the <code>BankAccount</code> class has no
behavior or validation. Anyone can set the balance to negative values,
and all the business logic is scattered in other classes.</p>
<hr />
<h2 id="refactoring-techniques-composing-methods">Refactoring
Techniques: Composing Methods</h2>
<h3 id="extract-method">Extract Method</h3>
<p><strong>When to Use</strong>: When you have code fragments that can
be grouped together, or when a method is too long and complex.</p>
<p><strong>Goal</strong>: Extract code into a clearly named method that
describes its purpose.</p>
<p><strong>Benefits</strong>: - Improves readability - Enables code
reuse - Makes testing easier - Reduces complexity</p>
<p><strong>Before and After Example</strong>:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Extract Method refactoring</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * We&#39;ll refactor the duplicated validation code from earlier</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">// BEFORE: Duplicated validation code</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> UserRegistrationBefore <span class="op">{</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">registerUser</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Validation code duplicated</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too short&quot;</span><span class="op">)</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&gt;</span> <span class="dv">20</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too long&quot;</span><span class="op">)</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>email<span class="op">.</span>contains<span class="op">(</span><span class="st">&quot;@&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Invalid email&quot;</span><span class="op">)</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;User registered: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">updateUser</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Same validation duplicated here</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too short&quot;</span><span class="op">)</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&gt;</span> <span class="dv">20</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too long&quot;</span><span class="op">)</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>email<span class="op">.</span>contains<span class="op">(</span><span class="st">&quot;@&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Invalid email&quot;</span><span class="op">)</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;User updated: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="co">// AFTER: Validation extracted into separate methods</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> UserRegistrationAfter <span class="op">{</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extracted method for username validation</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">isValidUsername</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too short&quot;</span><span class="op">)</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>username<span class="op">.</span>length <span class="op">&gt;</span> <span class="dv">20</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Username too long&quot;</span><span class="op">)</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extracted method for email validation</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">isValidEmail</span><span class="op">(</span><span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>email<span class="op">.</span>contains<span class="op">(</span><span class="st">&quot;@&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Invalid email&quot;</span><span class="op">)</span></span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Now the methods are much simpler</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">registerUser</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>isValidUsername<span class="op">(</span>username<span class="op">))</span> <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>isValidEmail<span class="op">(</span>email<span class="op">))</span> <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;User registered: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">updateUser</span><span class="op">(</span><span class="va">username</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">email</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>isValidUsername<span class="op">(</span>username<span class="op">))</span> <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>isValidEmail<span class="op">(</span>email<span class="op">))</span> <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;User updated: </span><span class="ss">$username</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE Refactoring ===&quot;</span><span class="op">)</span></span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">before</span> <span class="op">=</span> UserRegistrationBefore<span class="op">()</span></span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>    before<span class="op">.</span>registerUser<span class="op">(</span><span class="st">&quot;ab&quot;</span><span class="op">,</span> <span class="st">&quot;test@email.com&quot;</span><span class="op">,</span> <span class="st">&quot;pass123&quot;</span><span class="op">)</span></span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>    before<span class="op">.</span>registerUser<span class="op">(</span><span class="st">&quot;gooduser&quot;</span><span class="op">,</span> <span class="st">&quot;test@email.com&quot;</span><span class="op">,</span> <span class="st">&quot;pass123&quot;</span><span class="op">)</span></span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER Refactoring ===&quot;</span><span class="op">)</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">after</span> <span class="op">=</span> UserRegistrationAfter<span class="op">()</span></span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>    after<span class="op">.</span>registerUser<span class="op">(</span><span class="st">&quot;ab&quot;</span><span class="op">,</span> <span class="st">&quot;test@email.com&quot;</span><span class="op">,</span> <span class="st">&quot;pass123&quot;</span><span class="op">)</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>    after<span class="op">.</span>registerUser<span class="op">(</span><span class="st">&quot;gooduser&quot;</span><span class="op">,</span> <span class="st">&quot;test@email.com&quot;</span><span class="op">,</span> <span class="st">&quot;pass123&quot;</span><span class="op">)</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE Refactoring ===
Username too short
User registered: gooduser

=== AFTER Refactoring ===
Username too short
User registered: gooduser</code></pre>
<p>Notice how the extracted methods have clear, descriptive names that
explain what they do. The validation logic is now in one place, making
it easier to maintain and test.</p>
<hr />
<h3 id="introduce-explaining-variable">Introduce Explaining
Variable</h3>
<p><strong>When to Use</strong>: When you have a complicated expression
that’s hard to understand.</p>
<p><strong>Goal</strong>: Put the result of the expression (or parts of
it) in a well-named temporary variable.</p>
<p><strong>Benefits</strong>: - Makes complex logic more readable -
Self-documenting code - Easier to debug</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Introduce Explaining Variable refactoring</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Complex conditional logic is made clearer with explaining variables</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ShippingCalculator <span class="op">{</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// BEFORE: Complex expression that&#39;s hard to understand</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">calculateShippingBefore</span><span class="op">(</span><span class="va">weight</span><span class="op">:</span> <span class="dt">Double</span><span class="op">,</span> <span class="va">distance</span><span class="op">:</span> <span class="dt">Double</span><span class="op">,</span> <span class="va">isPriority</span><span class="op">:</span> <span class="dt">Boolean</span><span class="op">):</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="cf">if</span> <span class="op">((</span>weight <span class="op">&gt;</span> <span class="dv">10</span> <span class="op">&amp;&amp;</span> distance <span class="op">&gt;</span> <span class="dv">100</span><span class="op">)</span> <span class="op">||</span> <span class="op">(</span>isPriority <span class="op">&amp;&amp;</span> weight <span class="op">&gt;</span> <span class="dv">5</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>            weight <span class="op">*</span> <span class="fl">2.5</span> <span class="op">+</span> distance <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="op">(</span><span class="cf">if</span> <span class="op">(</span>isPriority<span class="op">)</span> <span class="fl">15.0</span> <span class="cf">else</span> <span class="fl">0.0</span><span class="op">)</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>            weight <span class="op">*</span> <span class="fl">1.5</span> <span class="op">+</span> distance <span class="op">*</span> <span class="fl">0.3</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// AFTER: Using explaining variables to make logic clear</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">calculateShippingAfter</span><span class="op">(</span><span class="va">weight</span><span class="op">:</span> <span class="dt">Double</span><span class="op">,</span> <span class="va">distance</span><span class="op">:</span> <span class="dt">Double</span><span class="op">,</span> <span class="va">isPriority</span><span class="op">:</span> <span class="dt">Boolean</span><span class="op">):</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Introduce explaining variables</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">isHeavyAndFar</span> <span class="op">=</span> weight <span class="op">&gt;</span> <span class="dv">10</span> <span class="op">&amp;&amp;</span> distance <span class="op">&gt;</span> <span class="dv">100</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">isPriorityAndHeavy</span> <span class="op">=</span> isPriority <span class="op">&amp;&amp;</span> weight <span class="op">&gt;</span> <span class="dv">5</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">requiresSpecialHandling</span> <span class="op">=</span> isHeavyAndFar <span class="op">||</span> isPriorityAndHeavy</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="co">// These explaining variables make the calculation clearer</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">baseWeightCost</span> <span class="op">=</span> <span class="cf">if</span> <span class="op">(</span>requiresSpecialHandling<span class="op">)</span> weight <span class="op">*</span> <span class="fl">2.5</span> <span class="cf">else</span> weight <span class="op">*</span> <span class="fl">1.5</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">distanceCost</span> <span class="op">=</span> <span class="cf">if</span> <span class="op">(</span>requiresSpecialHandling<span class="op">)</span> distance <span class="op">*</span> <span class="fl">0.5</span> <span class="cf">else</span> distance <span class="op">*</span> <span class="fl">0.3</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">prioritySurcharge</span> <span class="op">=</span> <span class="cf">if</span> <span class="op">(</span>isPriority<span class="op">)</span> <span class="fl">15.0</span> <span class="cf">else</span> <span class="fl">0.0</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">totalCost</span> <span class="op">=</span> baseWeightCost <span class="op">+</span> distanceCost <span class="op">+</span> prioritySurcharge</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> totalCost</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">calculator</span> <span class="op">=</span> ShippingCalculator<span class="op">()</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE: Hard to understand ===&quot;</span><span class="op">)</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">cost1</span> <span class="op">=</span> calculator<span class="op">.</span>calculateShippingBefore<span class="op">(</span><span class="fl">12.0</span><span class="op">,</span> <span class="fl">150.0</span><span class="op">,</span> <span class="kw">false</span><span class="op">)</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Cost: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>cost1<span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER: Clear and readable ===&quot;</span><span class="op">)</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">cost2</span> <span class="op">=</span> calculator<span class="op">.</span>calculateShippingAfter<span class="op">(</span><span class="fl">12.0</span><span class="op">,</span> <span class="fl">150.0</span><span class="op">,</span> <span class="kw">false</span><span class="op">)</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Cost: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>cost2<span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Test another scenario</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== Priority shipment ===&quot;</span><span class="op">)</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">cost3</span> <span class="op">=</span> calculator<span class="op">.</span>calculateShippingAfter<span class="op">(</span><span class="fl">6.0</span><span class="op">,</span> <span class="fl">80.0</span><span class="op">,</span> <span class="kw">true</span><span class="op">)</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Cost: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>cost3<span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE: Hard to understand ===
Cost: £105.00

=== AFTER: Clear and readable ===
Cost: £105.00

=== Priority shipment ===
Cost: £54.00</code></pre>
<p>The refactored version is much easier to understand. Each variable
name explains what the code is checking or calculating.</p>
<hr />
<h3 id="inline-method">Inline Method</h3>
<p><strong>When to Use</strong>: When a method’s body is just as clear
as (or clearer than) its name.</p>
<p><strong>Goal</strong>: Put the method’s body into its callers and
remove the method.</p>
<p><strong>When to Apply</strong>: This is less common than Extract
Method, but useful when: - The method is trivially simple - You have too
much indirection - The method name doesn’t add clarity</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Inline Method refactoring</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Sometimes a method is so simple that inlining makes code clearer</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ProductCatalog <span class="op">{</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">products</span> <span class="op">=</span> listOf<span class="op">(</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Laptop&quot;</span> to <span class="fl">999.99</span><span class="op">,</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Mouse&quot;</span> to <span class="fl">29.99</span><span class="op">,</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Keyboard&quot;</span> to <span class="fl">79.99</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// BEFORE: Unnecessary method that doesn&#39;t add value</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">isExpensiveBefore</span><span class="op">(</span><span class="va">price</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> price <span class="op">&gt;</span> <span class="fl">100.0</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getExpensiveProductsBefore</span><span class="op">():</span> <span class="dt">List</span><span class="op">&lt;</span><span class="dt">String</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">expensive</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;()</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">((</span>name<span class="op">,</span> price<span class="op">)</span> <span class="kw">in</span> products<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Calling a method that just wraps a simple comparison</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>isExpensiveBefore<span class="op">(</span>price<span class="op">))</span> <span class="op">{</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>                expensive<span class="op">.</span>add<span class="op">(</span>name<span class="op">)</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> expensive</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// AFTER: Inline the simple method for clarity</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getExpensiveProductsAfter</span><span class="op">():</span> <span class="dt">List</span><span class="op">&lt;</span><span class="dt">String</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">expensive</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;()</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">((</span>name<span class="op">,</span> price<span class="op">)</span> <span class="kw">in</span> products<span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Inlined the method - clearer without the indirection</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>price <span class="op">&gt;</span> <span class="fl">100.0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>                expensive<span class="op">.</span>add<span class="op">(</span>name<span class="op">)</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> expensive</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Or using Kotlin&#39;s functional approach (even better!)</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getExpensiveProductsKotlinWay</span><span class="op">():</span> <span class="dt">List</span><span class="op">&lt;</span><span class="dt">String</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> products</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>filter <span class="op">{</span> it<span class="op">.</span>second <span class="op">&gt;</span> <span class="fl">100.0</span> <span class="op">}</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>map <span class="op">{</span> it<span class="op">.</span>first <span class="op">}</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">catalog</span> <span class="op">=</span> ProductCatalog<span class="op">()</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE: Unnecessary indirection ===&quot;</span><span class="op">)</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">expensiveBefore</span> <span class="op">=</span> catalog<span class="op">.</span>getExpensiveProductsBefore<span class="op">()</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Expensive products: </span><span class="ss">$expensiveBefore</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER: Clearer with inlining ===&quot;</span><span class="op">)</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">expensiveAfter</span> <span class="op">=</span> catalog<span class="op">.</span>getExpensiveProductsAfter<span class="op">()</span></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Expensive products: </span><span class="ss">$expensiveAfter</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== BONUS: Kotlin functional style ===&quot;</span><span class="op">)</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">expensiveKotlin</span> <span class="op">=</span> catalog<span class="op">.</span>getExpensiveProductsKotlinWay<span class="op">()</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Expensive products: </span><span class="ss">$expensiveKotlin</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE: Unnecessary indirection ===
Expensive products: [Laptop]

=== AFTER: Clearer with inlining ===
Expensive products: [Laptop]

=== BONUS: Kotlin functional style ===
Expensive products: [Laptop]</code></pre>
<hr />
<h3 id="inline-temp">Inline Temp</h3>
<p><strong>When to Use</strong>: When you have a temporary variable
assigned once with a simple expression, and it’s getting in the way of
other refactorings.</p>
<p><strong>Goal</strong>: Replace all references to the temporary
variable with the expression itself.</p>
<p><strong>Steps</strong>: 1. Check there are no side effects 2. Make
the variable <code>val</code> (immutable) and compile to ensure it’s
only assigned once 3. Replace references with the expression</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Inline Temp refactoring</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Remove unnecessary temporary variables that don&#39;t add clarity</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DiscountCalculator <span class="op">{</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// BEFORE: Unnecessary temporary variable</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">calculateDiscountBefore</span><span class="op">(</span><span class="va">price</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">basePrice</span> <span class="op">=</span> price  <span class="co">// Unnecessary temp variable</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="cf">if</span> <span class="op">(</span>basePrice <span class="op">&gt;</span> <span class="dv">100</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            basePrice <span class="op">*</span> <span class="fl">0.9</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            basePrice <span class="op">*</span> <span class="fl">0.95</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// AFTER: Inline the temp variable</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">calculateDiscountAfter</span><span class="op">(</span><span class="va">price</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Directly use the parameter - clearer!</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="cf">if</span> <span class="op">(</span>price <span class="op">&gt;</span> <span class="dv">100</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>            price <span class="op">*</span> <span class="fl">0.9</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>            price <span class="op">*</span> <span class="fl">0.95</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Another example - BEFORE</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">isEligibleForFreeship</span> <span class="fu">pingBefore</span><span class="op">(</span><span class="va">total</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">orderTotal</span> <span class="op">=</span> total</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">shippingThreshold</span> <span class="op">=</span> <span class="fl">50.0</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">isEligible</span> <span class="op">=</span> orderTotal <span class="op">&gt;=</span> shippingThreshold</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> isEligible</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Another example - AFTER</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">isEligibleForFreeShippingAfter</span><span class="op">(</span><span class="va">total</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        <span class="co">// All those temp variables were just noise</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> total <span class="op">&gt;=</span> <span class="fl">50.0</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">calculator</span> <span class="op">=</span> DiscountCalculator<span class="op">()</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== Price Discounts ===&quot;</span><span class="op">)</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Before: £150 -&gt; £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>calculator<span class="op">.</span>calculateDiscountBefore<span class="op">(</span><span class="fl">150.0</span><span class="op">))</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;After:  £150 -&gt; £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>calculator<span class="op">.</span>calculateDiscountAfter<span class="op">(</span><span class="fl">150.0</span><span class="op">))</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== Free Shipping Eligibility ===&quot;</span><span class="op">)</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Before: £60 -&gt; </span><span class="ss">${</span>calculator<span class="op">.</span>isEligibleForFreeShippingBefore<span class="op">(</span><span class="fl">60.0</span><span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;After:  £60 -&gt; </span><span class="ss">${</span>calculator<span class="op">.</span>isEligibleForFreeShippingAfter<span class="op">(</span><span class="fl">60.0</span><span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== Price Discounts ===
Before: £150 -&gt; £135.00
After:  £150 -&gt; £135.00

=== Free Shipping Eligibility ===
Before: £60 -&gt; true
After:  £60 -&gt; true</code></pre>
<p><strong>Important Note</strong>: Only inline temps when they don’t
add clarity. If a temp variable has a meaningful name that explains a
complex expression, keep it!</p>
<hr />
<h2 id="refactoring-techniques-organizing-data">Refactoring Techniques:
Organizing Data</h2>
<h3 id="encapsulate-field">Encapsulate Field</h3>
<p><strong>When to Use</strong>: When you have a public field that
should be protected.</p>
<p><strong>Goal</strong>: Make the field private and provide accessors
(getters/setters).</p>
<p><strong>Benefits</strong>: - Control access to the field - Add
validation when setting values - Change internal representation without
affecting clients - Add logging or other cross-cutting concerns</p>
<p><strong>Kotlin Note</strong>: Kotlin properties automatically provide
getters and setters, but you can still customize them for
validation.</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Encapsulate Field refactoring</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Protecting fields with controlled access</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">// BEFORE: Public field - anyone can modify it</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PersonBefore <span class="op">{</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">age</span><span class="op">:</span> <span class="kw">Int</span> <span class="op">=</span> <span class="dv">0</span>  <span class="co">// Public field - no validation!</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">// AFTER: Encapsulated field with validation</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PersonAfter <span class="op">{</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Private backing field</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">var</span> <span class="va">_age</span><span class="op">:</span> <span class="kw">Int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Public property with custom setter for validation</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">age</span><span class="op">:</span> <span class="kw">Int</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">get</span><span class="op">()</span> <span class="op">=</span> _age</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">set</span><span class="op">(</span>value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>value <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>                println<span class="op">(</span><span class="st">&quot;Error: Age cannot be negative. Setting to 0.&quot;</span><span class="op">)</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>                _age <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>value <span class="op">&gt;</span> <span class="dv">150</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>                println<span class="op">(</span><span class="st">&quot;Warning: Age seems unusually high. Please verify.&quot;</span><span class="op">)</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                _age <span class="op">=</span> value</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>                _age <span class="op">=</span> value</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co">// More complex example with additional business logic</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BankAccountAfter <span class="op">{</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">var</span> <span class="va">_balance</span><span class="op">:</span> <span class="kw">Double</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">transactionHistory</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;()</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">balance</span><span class="op">:</span> <span class="kw">Double</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">get</span><span class="op">()</span> <span class="op">=</span> _balance</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Controlled access through methods instead of direct field access</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">deposit</span><span class="op">(</span><span class="va">amount</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>amount <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Error: Deposit amount must be positive&quot;</span><span class="op">)</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>        _balance <span class="op">+=</span> amount</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>        transactionHistory<span class="op">.</span>add<span class="op">(</span><span class="st">&quot;Deposit: +£</span><span class="ss">$amount</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Deposited £</span><span class="ss">$amount</span><span class="st">. New balance: £</span><span class="ss">$_balance</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">withdraw</span><span class="op">(</span><span class="va">amount</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>amount <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Error: Withdrawal amount must be positive&quot;</span><span class="op">)</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>amount <span class="op">&gt;</span> _balance<span class="op">)</span> <span class="op">{</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Error: Insufficient funds&quot;</span><span class="op">)</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>        _balance <span class="op">-=</span> amount</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>        transactionHistory<span class="op">.</span>add<span class="op">(</span><span class="st">&quot;Withdrawal: -£</span><span class="ss">$amount</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Withdrew £</span><span class="ss">$amount</span><span class="st">. New balance: £</span><span class="ss">$_balance</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getTransactionHistory</span><span class="op">():</span> <span class="dt">List</span><span class="op">&lt;</span><span class="dt">String</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Return a copy to prevent external modification</span></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> transactionHistory<span class="op">.</span>toList<span class="op">()</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE: No protection ===&quot;</span><span class="op">)</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">personBefore</span> <span class="op">=</span> PersonBefore<span class="op">()</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>    personBefore<span class="op">.</span>age <span class="op">=</span> <span class="op">-</span><span class="dv">5</span>  <span class="co">// This shouldn&#39;t be allowed!</span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Age set to: </span><span class="ss">${</span>personBefore<span class="op">.</span>age<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER: Protected with validation ===&quot;</span><span class="op">)</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">personAfter</span> <span class="op">=</span> PersonAfter<span class="op">()</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>    personAfter<span class="op">.</span>age <span class="op">=</span> <span class="op">-</span><span class="dv">5</span>  <span class="co">// Validation prevents invalid value</span></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Age is: </span><span class="ss">${</span>personAfter<span class="op">.</span>age<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>    personAfter<span class="op">.</span>age <span class="op">=</span> <span class="dv">25</span>  <span class="co">// Valid value</span></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Age is: </span><span class="ss">${</span>personAfter<span class="op">.</span>age<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== Bank Account Example ===&quot;</span><span class="op">)</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">account</span> <span class="op">=</span> BankAccountAfter<span class="op">()</span></span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>deposit<span class="op">(</span><span class="fl">100.0</span><span class="op">)</span></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>withdraw<span class="op">(</span><span class="fl">30.0</span><span class="op">)</span></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>withdraw<span class="op">(</span><span class="fl">1000.0</span><span class="op">)</span>  <span class="co">// Should fail</span></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Transaction History:&quot;</span><span class="op">)</span></span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>    account<span class="op">.</span>getTransactionHistory<span class="op">().</span>forEach <span class="op">{</span> println<span class="op">(</span><span class="st">&quot;  </span><span class="ss">$it</span><span class="st">&quot;</span><span class="op">)</span> <span class="op">}</span></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE: No protection ===
Age set to: -5

=== AFTER: Protected with validation ===
Error: Age cannot be negative. Setting to 0.
Age is: 0
Age is: 25

=== Bank Account Example ===
Deposited £100.0. New balance: £100.0
Withdrew £30.0. New balance: £70.0
Error: Insufficient funds

Transaction History:
  Deposit: +£100.0
  Withdrawal: -£30.0</code></pre>
<hr />
<h3 id="encapsulate-collection">Encapsulate Collection</h3>
<p><strong>When to Use</strong>: When a method returns a collection that
can be modified from outside the class.</p>
<p><strong>Goal</strong>: Make the method return a read-only view and
provide add/remove methods.</p>
<p><strong>Why It Matters</strong>: Allowing direct access to a mutable
collection breaks encapsulation. Clients can modify your internal state
without your knowledge.</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Encapsulate Collection refactoring</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Protecting collections from unauthorized modification</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">// BEFORE: Collection can be modified from outside</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CourseRosterBefore <span class="op">{</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">students</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;()</span>  <span class="co">// Exposed mutable list!</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">printRoster</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Students enrolled: </span><span class="ss">${</span>students<span class="op">.</span>size<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        students<span class="op">.</span>forEach <span class="op">{</span> println<span class="op">(</span><span class="st">&quot;  - </span><span class="ss">$it</span><span class="st">&quot;</span><span class="op">)</span> <span class="op">}</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co">// AFTER: Collection is encapsulated with controlled access</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CourseRosterAfter <span class="op">{</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Private mutable collection</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">_students</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;()</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Public read-only view</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">students</span><span class="op">:</span> List<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">get</span><span class="op">()</span> <span class="op">=</span> _students<span class="op">.</span>toList<span class="op">()</span>  <span class="co">// Returns a copy</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Controlled methods to modify the collection</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">addStudent</span><span class="op">(</span><span class="va">name</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>name<span class="op">.</span>isBlank<span class="op">())</span> <span class="op">{</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Error: Student name cannot be blank&quot;</span><span class="op">)</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>_students<span class="op">.</span>contains<span class="op">(</span>name<span class="op">))</span> <span class="op">{</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Error: Student </span><span class="ss">$name</span><span class="st"> is already enrolled&quot;</span><span class="op">)</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>        _students<span class="op">.</span>add<span class="op">(</span>name<span class="op">)</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Added student: </span><span class="ss">$name</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">removeStudent</span><span class="op">(</span><span class="va">name</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>_students<span class="op">.</span>remove<span class="op">(</span>name<span class="op">))</span> <span class="op">{</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Removed student: </span><span class="ss">$name</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">true</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Error: Student </span><span class="ss">$name</span><span class="st"> not found&quot;</span><span class="op">)</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> <span class="kw">false</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getStudentCount</span><span class="op">():</span> <span class="dt">Int</span> <span class="op">=</span> _students<span class="op">.</span>size</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">printRoster</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Students enrolled: </span><span class="ss">${</span>_students<span class="op">.</span>size<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>        _students<span class="op">.</span>forEach <span class="op">{</span> println<span class="op">(</span><span class="st">&quot;  - </span><span class="ss">$it</span><span class="st">&quot;</span><span class="op">)</span> <span class="op">}</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE: Unprotected collection ===&quot;</span><span class="op">)</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">courseBefore</span> <span class="op">=</span> CourseRosterBefore<span class="op">()</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>    courseBefore<span class="op">.</span>students<span class="op">.</span>add<span class="op">(</span><span class="st">&quot;Alice&quot;</span><span class="op">)</span></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>    courseBefore<span class="op">.</span>students<span class="op">.</span>add<span class="op">(</span><span class="st">&quot;Bob&quot;</span><span class="op">)</span></span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>    courseBefore<span class="op">.</span>printRoster<span class="op">()</span></span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">// The problem: anyone can do this!</span></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>    courseBefore<span class="op">.</span>students<span class="op">.</span>clear<span class="op">()</span>  <span class="co">// Oops, deleted all students!</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">After external modification:&quot;</span><span class="op">)</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>    courseBefore<span class="op">.</span>printRoster<span class="op">()</span></span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER: Protected collection ===&quot;</span><span class="op">)</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">courseAfter</span> <span class="op">=</span> CourseRosterAfter<span class="op">()</span></span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>    courseAfter<span class="op">.</span>addStudent<span class="op">(</span><span class="st">&quot;Alice&quot;</span><span class="op">)</span></span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>    courseAfter<span class="op">.</span>addStudent<span class="op">(</span><span class="st">&quot;Bob&quot;</span><span class="op">)</span></span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>    courseAfter<span class="op">.</span>addStudent<span class="op">(</span><span class="st">&quot;Alice&quot;</span><span class="op">)</span>  <span class="co">// Duplicate - should be prevented</span></span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>    courseAfter<span class="op">.</span>printRoster<span class="op">()</span></span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Now this won&#39;t work - students returns a read-only List</span></span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">// courseAfter.students.clear()  // This would be a compile error!</span></span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Attempting to remove:&quot;</span><span class="op">)</span></span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>    courseAfter<span class="op">.</span>removeStudent<span class="op">(</span><span class="st">&quot;Bob&quot;</span><span class="op">)</span></span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>    courseAfter<span class="op">.</span>removeStudent<span class="op">(</span><span class="st">&quot;Charlie&quot;</span><span class="op">)</span>  <span class="co">// Not enrolled</span></span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Final roster:&quot;</span><span class="op">)</span></span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>    courseAfter<span class="op">.</span>printRoster<span class="op">()</span></span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE: Unprotected collection ===
Students enrolled: 2
  - Alice
  - Bob

After external modification:
Students enrolled: 0

=== AFTER: Protected collection ===
Added student: Alice
Added student: Bob
Error: Student Alice is already enrolled
Students enrolled: 2
  - Alice
  - Bob

Attempting to remove:
Removed student: Bob
Error: Student Charlie not found

Final roster:
Students enrolled: 1
  - Alice</code></pre>
<hr />
<h3 id="replace-type-code-with-class">Replace Type Code with Class</h3>
<p><strong>When to Use</strong>: When a class uses numeric type codes
(like integers or strings) to represent types or categories.</p>
<p><strong>Goal</strong>: Replace the primitive type code with a class
(often an enum class in Kotlin).</p>
<p><strong>Benefits</strong>: - Type safety - compiler catches errors -
Self-documenting code - Can add behavior to the type - Easier to add new
types</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Replace Type Code with Class refactoring</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Using type-safe enums instead of magic numbers</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">// BEFORE: Using &quot;magic numbers&quot; for employee types</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EmployeeBefore<span class="op">(</span><span class="kw">val</span> <span class="va">name</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="kw">val</span> <span class="va">employeeType</span><span class="op">:</span> <span class="dt">Int</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">companion</span> <span class="kw">object</span> <span class="op">{</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> <span class="kw">val</span> <span class="va">ENGINEER</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> <span class="kw">val</span> <span class="va">MANAGER</span> <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> <span class="kw">val</span> <span class="va">SALESPERSON</span> <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getBonus</span><span class="op">():</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="cf">when</span> <span class="op">(</span>employeeType<span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>            ENGINEER <span class="op">-&gt;</span> <span class="fl">1000.0</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>            MANAGER <span class="op">-&gt;</span> <span class="fl">2000.0</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>            SALESPERSON <span class="op">-&gt;</span> <span class="fl">1500.0</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">-&gt;</span> <span class="fl">0.0</span>  <span class="co">// Easy to forget cases!</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getTypeDescription</span><span class="op">():</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="cf">when</span> <span class="op">(</span>employeeType<span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>            ENGINEER <span class="op">-&gt;</span> <span class="st">&quot;Engineer&quot;</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>            MANAGER <span class="op">-&gt;</span> <span class="st">&quot;Manager&quot;</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>            SALESPERSON <span class="op">-&gt;</span> <span class="st">&quot;Salesperson&quot;</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">-&gt;</span> <span class="st">&quot;Unknown&quot;</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="co">// AFTER: Using a type-safe enum</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> <span class="kw">class</span> EmployeeType<span class="op">(</span><span class="kw">val</span> <span class="va">description</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="kw">val</span> <span class="va">baseBonus</span><span class="op">:</span> <span class="dt">Double</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    ENGINEER<span class="op">(</span><span class="st">&quot;Engineer&quot;</span><span class="op">,</span> <span class="fl">1000.0</span><span class="op">),</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    MANAGER<span class="op">(</span><span class="st">&quot;Manager&quot;</span><span class="op">,</span> <span class="fl">2000.0</span><span class="op">),</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    SALESPERSON<span class="op">(</span><span class="st">&quot;Salesperson&quot;</span><span class="op">,</span> <span class="fl">1500.0</span><span class="op">);</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Can add behavior to the enum</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getPerformanceMultiplier</span><span class="op">(</span><span class="va">performanceRating</span><span class="op">:</span> <span class="dt">Int</span><span class="op">):</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="cf">when</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>            ENGINEER <span class="op">-&gt;</span> <span class="cf">if</span> <span class="op">(</span>performanceRating <span class="op">&gt;</span> <span class="dv">8</span><span class="op">)</span> <span class="fl">1.5</span> <span class="cf">else</span> <span class="fl">1.0</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>            MANAGER <span class="op">-&gt;</span> <span class="cf">if</span> <span class="op">(</span>performanceRating <span class="op">&gt;</span> <span class="dv">7</span><span class="op">)</span> <span class="fl">1.8</span> <span class="cf">else</span> <span class="fl">1.0</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>            SALESPERSON <span class="op">-&gt;</span> <span class="cf">if</span> <span class="op">(</span>performanceRating <span class="op">&gt;</span> <span class="dv">9</span><span class="op">)</span> <span class="fl">2.0</span> <span class="cf">else</span> <span class="fl">1.0</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EmployeeAfter<span class="op">(</span><span class="kw">val</span> <span class="va">name</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="kw">val</span> <span class="va">employeeType</span><span class="op">:</span> <span class="dt">EmployeeType</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getBonus</span><span class="op">(</span><span class="va">performanceRating</span><span class="op">:</span> <span class="dt">Int</span><span class="op">):</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">multiplier</span> <span class="op">=</span> employeeType<span class="op">.</span>getPerformanceMultiplier<span class="op">(</span>performanceRating<span class="op">)</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> employeeType<span class="op">.</span>baseBonus <span class="op">*</span> multiplier</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getTypeDescription</span><span class="op">():</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> employeeType<span class="op">.</span>description</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE: Magic numbers ===&quot;</span><span class="op">)</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">emp1</span> <span class="op">=</span> EmployeeBefore<span class="op">(</span><span class="st">&quot;Alice&quot;</span><span class="op">,</span> EmployeeBefore<span class="op">.</span>ENGINEER<span class="op">)</span></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="ss">${</span>emp1<span class="op">.</span>name<span class="ss">}</span><span class="st"> (</span><span class="ss">${</span>emp1<span class="op">.</span>getTypeDescription<span class="op">()</span><span class="ss">}</span><span class="st">): Bonus = £</span><span class="ss">${</span>emp1<span class="op">.</span>getBonus<span class="op">()</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>    <span class="co">// The problem: easy to pass invalid values</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">emp2</span> <span class="op">=</span> EmployeeBefore<span class="op">(</span><span class="st">&quot;Bob&quot;</span><span class="op">,</span> <span class="dv">99</span><span class="op">)</span>  <span class="co">// Invalid type code!</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="ss">${</span>emp2<span class="op">.</span>name<span class="ss">}</span><span class="st"> (</span><span class="ss">${</span>emp2<span class="op">.</span>getTypeDescription<span class="op">()</span><span class="ss">}</span><span class="st">): Bonus = £</span><span class="ss">${</span>emp2<span class="op">.</span>getBonus<span class="op">()</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER: Type-safe enum ===&quot;</span><span class="op">)</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">emp3</span> <span class="op">=</span> EmployeeAfter<span class="op">(</span><span class="st">&quot;Charlie&quot;</span><span class="op">,</span> EmployeeType<span class="op">.</span>ENGINEER<span class="op">)</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="ss">${</span>emp3<span class="op">.</span>name<span class="ss">}</span><span class="st"> (</span><span class="ss">${</span>emp3<span class="op">.</span>getTypeDescription<span class="op">()</span><span class="ss">}</span><span class="st">): &quot;</span> <span class="op">+</span></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Bonus (rating 9) = £</span><span class="ss">${</span>emp3<span class="op">.</span>getBonus<span class="op">(</span><span class="dv">9</span><span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">emp4</span> <span class="op">=</span> EmployeeAfter<span class="op">(</span><span class="st">&quot;Diana&quot;</span><span class="op">,</span> EmployeeType<span class="op">.</span>MANAGER<span class="op">)</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="ss">${</span>emp4<span class="op">.</span>name<span class="ss">}</span><span class="st"> (</span><span class="ss">${</span>emp4<span class="op">.</span>getTypeDescription<span class="op">()</span><span class="ss">}</span><span class="st">): &quot;</span> <span class="op">+</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Bonus (rating 8) = £</span><span class="ss">${</span>emp4<span class="op">.</span>getBonus<span class="op">(</span><span class="dv">8</span><span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>    <span class="co">// This won&#39;t compile - type safety!</span></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>    <span class="co">// val emp5 = EmployeeAfter(&quot;Eve&quot;, 99)  // Compiler error!</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE: Magic numbers ===
Alice (Engineer): Bonus = £1000.0
Bob (Unknown): Bonus = £0.0

=== AFTER: Type-safe enum ===
Charlie (Engineer): Bonus (rating 9) = £1500.0
Diana (Manager): Bonus (rating 8) = £3600.0</code></pre>
<hr />
<h2 id="refactoring-techniques-making-method-calls-simpler">Refactoring
Techniques: Making Method Calls Simpler</h2>
<h3 id="remove-setting-method">Remove Setting Method</h3>
<p><strong>When to Use</strong>: When a field should be set at creation
time and never changed afterward.</p>
<p><strong>Goal</strong>: Remove any setter method for that field and
make it immutable.</p>
<p><strong>Benefits</strong>: - Immutability prevents bugs - Makes the
object’s lifecycle clearer - Thread-safe - Easier to reason about</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Remove Setting Method refactoring</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Making fields immutable when they shouldn&#39;t change after construction</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">// BEFORE: Mutable ID that shouldn&#39;t be mutable</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DocumentBefore <span class="op">{</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">documentId</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;&quot;</span>  <span class="co">// Shouldn&#39;t be changeable!</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">title</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">content</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">createdDate</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">display</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Document ID: </span><span class="ss">$documentId</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Title: </span><span class="ss">$title</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Created: </span><span class="ss">$createdDate</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Content: </span><span class="ss">$content</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co">// AFTER: ID is immutable</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DocumentAfter<span class="op">(</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">documentId</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span>  <span class="co">// Immutable - set at construction</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">title</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span>        <span class="co">// Still mutable - can be changed</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> <span class="va">content</span><span class="op">:</span> <span class="dt">String</span>       <span class="co">// Still mutable - can be changed</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">createdDate</span><span class="op">:</span> <span class="kw">String</span> <span class="op">=</span> java<span class="op">.</span>time<span class="op">.</span>LocalDateTime<span class="op">.</span>now<span class="op">().</span>toString<span class="op">()</span>  <span class="co">// Set once</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// No setter for documentId or createdDate!</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">// They can only be set during construction</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">display</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Document ID: </span><span class="ss">$documentId</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Title: </span><span class="ss">$title</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Created: </span><span class="ss">$createdDate</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Content: </span><span class="ss">$content</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="co">// Another example: Bank Account with immutable account number</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BankAccountAfter<span class="op">(</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">accountNumber</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span>  <span class="co">// Immutable</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">accountHolder</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span>  <span class="co">// Immutable</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    <span class="va">initialBalance</span><span class="op">:</span> <span class="dt">Double</span> <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="op">)</span> <span class="op">{</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">var</span> <span class="va">_balance</span><span class="op">:</span> <span class="kw">Double</span> <span class="op">=</span> initialBalance</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">balance</span><span class="op">:</span> <span class="kw">Double</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">get</span><span class="op">()</span> <span class="op">=</span> _balance</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">deposit</span><span class="op">(</span><span class="va">amount</span><span class="op">:</span> <span class="dt">Double</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>amount <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>            _balance <span class="op">+=</span> amount</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>            println<span class="op">(</span><span class="st">&quot;Deposited £</span><span class="ss">$amount</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE: Dangerous mutability ===&quot;</span><span class="op">)</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">docBefore</span> <span class="op">=</span> DocumentBefore<span class="op">()</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>    docBefore<span class="op">.</span>documentId <span class="op">=</span> <span class="st">&quot;DOC-001&quot;</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    docBefore<span class="op">.</span>title <span class="op">=</span> <span class="st">&quot;Important Report&quot;</span></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    docBefore<span class="op">.</span>content <span class="op">=</span> <span class="st">&quot;Confidential information&quot;</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>    docBefore<span class="op">.</span>display<span class="op">()</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">The problem - ID can be changed!&quot;</span><span class="op">)</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    docBefore<span class="op">.</span>documentId <span class="op">=</span> <span class="st">&quot;HACKED&quot;</span>  <span class="co">// This shouldn&#39;t be possible!</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>    docBefore<span class="op">.</span>display<span class="op">()</span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER: Protected immutability ===&quot;</span><span class="op">)</span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">docAfter</span> <span class="op">=</span> DocumentAfter<span class="op">(</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>        documentId <span class="op">=</span> <span class="st">&quot;DOC-002&quot;</span><span class="op">,</span></span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> <span class="st">&quot;Important Report&quot;</span><span class="op">,</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>        content <span class="op">=</span> <span class="st">&quot;Confidential information&quot;</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">)</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>    docAfter<span class="op">.</span>display<span class="op">()</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>    <span class="co">// This won&#39;t compile - documentId is immutable!</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>    <span class="co">// docAfter.documentId = &quot;HACKED&quot;  // Compiler error!</span></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">// But we can still change content</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>    docAfter<span class="op">.</span>title <span class="op">=</span> <span class="st">&quot;Updated Report Title&quot;</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">After updating title:&quot;</span><span class="op">)</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>    docAfter<span class="op">.</span>display<span class="op">()</span></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== Bank Account Example ===&quot;</span><span class="op">)</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">account</span> <span class="op">=</span> BankAccountAfter<span class="op">(</span><span class="st">&quot;ACC-12345&quot;</span><span class="op">,</span> <span class="st">&quot;Alice Smith&quot;</span><span class="op">,</span> <span class="fl">100.0</span><span class="op">)</span></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Account: </span><span class="ss">${</span>account<span class="op">.</span>accountNumber<span class="ss">}</span><span class="st">, Holder: </span><span class="ss">${</span>account<span class="op">.</span>accountHolder<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Balance: £</span><span class="ss">${</span>account<span class="op">.</span>balance<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>    <span class="co">// account.accountNumber = &quot;CHANGED&quot;  // Compiler error - immutable!</span></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE: Dangerous mutability ===
Document ID: DOC-001
Title: Important Report
Created: 
Content: Confidential information

The problem - ID can be changed!
Document ID: HACKED
Title: Important Report
Created: 
Content: Confidential information

=== AFTER: Protected immutability ===
Document ID: DOC-002
Title: Important Report
Created: 2024-11-21T14:23:45.678
Content: Confidential information

After updating title:
Document ID: DOC-002
Title: Updated Report Title
Created: 2024-11-21T14:23:45.678
Content: Confidential information

=== Bank Account Example ===
Account: ACC-12345, Holder: Alice Smith
Balance: £100.0</code></pre>
<hr />
<h3 id="hide-method">Hide Method</h3>
<p><strong>When to Use</strong>: When a method is not used by any other
class.</p>
<p><strong>Goal</strong>: Make the method private to reduce the public
interface.</p>
<p><strong>Benefits</strong>: - Smaller public API is easier to
understand - More flexibility to change implementation - Prevents misuse
of internal methods - Clearer class interface</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Hide Method refactoring</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Making internal helper methods private</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">// BEFORE: Helper methods are public unnecessarily</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ReportGeneratorBefore <span class="op">{</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">generateReport</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">List</span>&lt;<span class="va">Int</span>&gt;<span class="op">):</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">cleaned</span> <span class="op">=</span> cleanData<span class="op">(</span><span class="kw">data</span><span class="op">)</span>  <span class="co">// Helper method</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">analyzed</span> <span class="op">=</span> analyzeData<span class="op">(</span>cleaned<span class="op">)</span>  <span class="co">// Helper method</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> formatReport<span class="op">(</span>analyzed<span class="op">)</span>  <span class="co">// Helper method</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// These are public but only used internally!</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">cleanData</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">List</span>&lt;<span class="va">Int</span>&gt;<span class="op">):</span> <span class="dt">List</span><span class="op">&lt;</span><span class="dt">Int</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">data</span><span class="op">.</span>filter <span class="op">{</span> it <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">}</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">analyzeData</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">List</span>&lt;<span class="va">Int</span>&gt;<span class="op">):</span> <span class="dt">Map</span><span class="op">&lt;</span><span class="dt">String</span>, <span class="dt">Double</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> mapOf<span class="op">(</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;average&quot;</span> to <span class="kw">data</span><span class="op">.</span>average<span class="op">(),</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;max&quot;</span> to <span class="kw">data</span><span class="op">.</span>maxOrNull<span class="op">()?.</span>toDouble<span class="op">()</span> <span class="op">?:</span> <span class="fl">0.0</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">formatReport</span><span class="op">(</span><span class="va">analysis</span><span class="op">:</span> <span class="dt">Map</span>&lt;<span class="va">String</span><span class="op">,</span> <span class="va">Double</span>&gt;<span class="op">):</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;Analysis Report</span><span class="sc">\n</span><span class="st">&quot;</span> <span class="op">+</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Average: </span><span class="ss">${</span>analysis<span class="op">[</span><span class="st">&quot;average&quot;</span><span class="op">]</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span> <span class="op">+</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Maximum: </span><span class="ss">${</span>analysis<span class="op">[</span><span class="st">&quot;max&quot;</span><span class="op">]</span><span class="ss">}</span><span class="st">&quot;</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co">// AFTER: Helper methods are private</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ReportGeneratorAfter <span class="op">{</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Main public method</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">generateReport</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">List</span>&lt;<span class="va">Int</span>&gt;<span class="op">):</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">cleaned</span> <span class="op">=</span> cleanData<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">analyzed</span> <span class="op">=</span> analyzeData<span class="op">(</span>cleaned<span class="op">)</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> formatReport<span class="op">(</span>analyzed<span class="op">)</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Private helper methods - not part of public API</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">cleanData</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">List</span>&lt;<span class="va">Int</span>&gt;<span class="op">):</span> <span class="dt">List</span><span class="op">&lt;</span><span class="dt">Int</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="kw">data</span><span class="op">.</span>filter <span class="op">{</span> it <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">}</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">analyzeData</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">List</span>&lt;<span class="va">Int</span>&gt;<span class="op">):</span> <span class="dt">Map</span><span class="op">&lt;</span><span class="dt">String</span>, <span class="dt">Double</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> mapOf<span class="op">(</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;average&quot;</span> to <span class="kw">data</span><span class="op">.</span>average<span class="op">(),</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;max&quot;</span> to <span class="kw">data</span><span class="op">.</span>maxOrNull<span class="op">()?.</span>toDouble<span class="op">()</span> <span class="op">?:</span> <span class="fl">0.0</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">formatReport</span><span class="op">(</span><span class="va">analysis</span><span class="op">:</span> <span class="dt">Map</span>&lt;<span class="va">String</span><span class="op">,</span> <span class="va">Double</span>&gt;<span class="op">):</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;Analysis Report</span><span class="sc">\n</span><span class="st">&quot;</span> <span class="op">+</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Average: </span><span class="ss">${</span>analysis<span class="op">[</span><span class="st">&quot;average&quot;</span><span class="op">]</span><span class="ss">}</span><span class="sc">\n</span><span class="st">&quot;</span> <span class="op">+</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Maximum: </span><span class="ss">${</span>analysis<span class="op">[</span><span class="st">&quot;max&quot;</span><span class="op">]</span><span class="ss">}</span><span class="st">&quot;</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> listOf<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="op">-</span><span class="dv">5</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">40</span><span class="op">)</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE: Too many public methods ===&quot;</span><span class="op">)</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">generatorBefore</span> <span class="op">=</span> ReportGeneratorBefore<span class="op">()</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Public methods available:&quot;</span><span class="op">)</span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;- generateReport()&quot;</span><span class="op">)</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;- cleanData()  &lt;- Should be private!&quot;</span><span class="op">)</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;- analyzeData()  &lt;- Should be private!&quot;</span><span class="op">)</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;- formatReport()  &lt;- Should be private!&quot;</span><span class="op">)</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">// The problem: clients can call internal methods</span></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">cleaned</span> <span class="op">=</span> generatorBefore<span class="op">.</span>cleanData<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">Cleaned data (direct access): </span><span class="ss">$cleaned</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">report</span> <span class="op">=</span> generatorBefore<span class="op">.</span>generateReport<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="ss">$report</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER: Clean public interface ===&quot;</span><span class="op">)</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">generatorAfter</span> <span class="op">=</span> ReportGeneratorAfter<span class="op">()</span></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Public methods available:&quot;</span><span class="op">)</span></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;- generateReport()  &lt;- Only this is public&quot;</span><span class="op">)</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>    <span class="co">// These won&#39;t compile - methods are private!</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>    <span class="co">// val cleaned2 = generatorAfter.cleanData(data)  // Compiler error!</span></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>    <span class="co">// val analyzed = generatorAfter.analyzeData(cleaned)  // Compiler error!</span></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">report2</span> <span class="op">=</span> generatorAfter<span class="op">.</span>generateReport<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="ss">$report2</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE: Too many public methods ===
Public methods available:
- generateReport()
- cleanData()  &lt;- Should be private!
- analyzeData()  &lt;- Should be private!
- formatReport()  &lt;- Should be private!

Cleaned data (direct access): [10, 20, 30, 40]

Analysis Report
Average: 25.0
Maximum: 40.0

=== AFTER: Clean public interface ===
Public methods available:
- generateReport()  &lt;- Only this is public

Analysis Report
Average: 25.0
Maximum: 40.0</code></pre>
<hr />
<h3 id="rename-method">Rename Method</h3>
<p><strong>When to Use</strong>: When a method’s name doesn’t clearly
reveal its purpose.</p>
<p><strong>Goal</strong>: Change the method name to something that
clearly describes what it does.</p>
<p><strong>Benefits</strong>: - Self-documenting code - Easier to
understand without reading implementation - Reduces need for comments -
Makes the API more intuitive</p>
<p><strong>Important</strong>: In Kotlin/Java, always check if the
method is inherited or overrides a parent method before renaming.</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Rename Method refactoring</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Giving methods clear, descriptive names</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">// BEFORE: Unclear method names</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ShoppingCartBefore <span class="op">{</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">items</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span>Pair<span class="op">&lt;</span><span class="kw">String</span><span class="op">,</span> <span class="kw">Double</span><span class="op">&gt;&gt;()</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// What does &#39;add&#39; add? Not clear!</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">add</span><span class="op">(</span><span class="va">name</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">price</span><span class="op">:</span> <span class="dt">Double</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        items<span class="op">.</span>add<span class="op">(</span>Pair<span class="op">(</span>name<span class="op">,</span> price<span class="op">))</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// What does &#39;calc&#39; calculate? Ambiguous!</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">calc</span><span class="op">():</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> items<span class="op">.</span>sumOf <span class="op">{</span> it<span class="op">.</span>second <span class="op">}</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// &#39;get&#39; is vague</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="kw">get</span><span class="op">():</span> <span class="dt">Int</span> <span class="op">{</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> items<span class="op">.</span>size</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Single letter method name - terrible!</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">c</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>        items<span class="op">.</span>clear<span class="op">()</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="co">// AFTER: Clear, descriptive method names</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ShoppingCartAfter <span class="op">{</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">items</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span>Pair<span class="op">&lt;</span><span class="kw">String</span><span class="op">,</span> <span class="kw">Double</span><span class="op">&gt;&gt;()</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Clear and descriptive</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">addItem</span><span class="op">(</span><span class="va">name</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">price</span><span class="op">:</span> <span class="dt">Double</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>        items<span class="op">.</span>add<span class="op">(</span>Pair<span class="op">(</span>name<span class="op">,</span> price<span class="op">))</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Added: </span><span class="ss">$name</span><span class="st"> (£</span><span class="ss">$price</span><span class="st">)&quot;</span><span class="op">)</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Exactly describes what it does</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">calculateTotalPrice</span><span class="op">():</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> items<span class="op">.</span>sumOf <span class="op">{</span> it<span class="op">.</span>second <span class="op">}</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Much clearer than &#39;get&#39;</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">getItemCount</span><span class="op">():</span> <span class="dt">Int</span> <span class="op">{</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> items<span class="op">.</span>size</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Clearly states the action</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">clearCart</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>        items<span class="op">.</span>clear<span class="op">()</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Cart cleared&quot;</span><span class="op">)</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Bonus: descriptive name for a complex calculation</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">calculateTotalWithTax</span><span class="op">(</span><span class="va">taxRate</span><span class="op">:</span> <span class="dt">Double</span><span class="op">):</span> <span class="dt">Double</span> <span class="op">{</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">subtotal</span> <span class="op">=</span> calculateTotalPrice<span class="op">()</span></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">tax</span> <span class="op">=</span> subtotal <span class="op">*</span> taxRate</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> subtotal <span class="op">+</span> tax</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== BEFORE: Unclear names ===&quot;</span><span class="op">)</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">cartBefore</span> <span class="op">=</span> ShoppingCartBefore<span class="op">()</span></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>    cartBefore<span class="op">.</span>add<span class="op">(</span><span class="st">&quot;Laptop&quot;</span><span class="op">,</span> <span class="fl">999.99</span><span class="op">)</span>  <span class="co">// What am I adding?</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>    cartBefore<span class="op">.</span>add<span class="op">(</span><span class="st">&quot;Mouse&quot;</span><span class="op">,</span> <span class="fl">29.99</span><span class="op">)</span></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Total: £</span><span class="ss">${</span>cartBefore<span class="op">.</span>calc<span class="op">()</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span>  <span class="co">// Total what?</span></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Items: </span><span class="ss">${</span>cartBefore<span class="op">.</span><span class="kw">get</span><span class="op">()</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span>  <span class="co">// Get what?</span></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== AFTER: Clear, descriptive names ===&quot;</span><span class="op">)</span></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">cartAfter</span> <span class="op">=</span> ShoppingCartAfter<span class="op">()</span></span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>    cartAfter<span class="op">.</span>addItem<span class="op">(</span><span class="st">&quot;Laptop&quot;</span><span class="op">,</span> <span class="fl">999.99</span><span class="op">)</span>  <span class="co">// Clear: adding an item</span></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>    cartAfter<span class="op">.</span>addItem<span class="op">(</span><span class="st">&quot;Mouse&quot;</span><span class="op">,</span> <span class="fl">29.99</span><span class="op">)</span></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">subtotal</span> <span class="op">=</span> cartAfter<span class="op">.</span>calculateTotalPrice<span class="op">()</span>  <span class="co">// Clear: calculating price</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Subtotal: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>subtotal<span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">totalWithTax</span> <span class="op">=</span> cartAfter<span class="op">.</span>calculateTotalWithTax<span class="op">(</span><span class="fl">0.20</span><span class="op">)</span>  <span class="co">// Clear: price with tax</span></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Total with 20% tax: £</span><span class="ss">${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>totalWithTax<span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Number of items: </span><span class="ss">${</span>cartAfter<span class="op">.</span>getItemCount<span class="op">()</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span>  <span class="co">// Clear: item count</span></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== BEFORE: Unclear names ===
Total: £1029.98
Items: 2

=== AFTER: Clear, descriptive names ===
Added: Laptop (£999.99)
Added: Mouse (£29.99)
Subtotal: £1029.98
Total with 20% tax: £1235.98
Number of items: 2</code></pre>
<p><strong>Naming Guidelines</strong>: - Use verbs for methods that
perform actions: <code>calculateTotal</code>, <code>sendEmail</code>,
<code>validateInput</code> - Use <code>get</code> prefix for accessors:
<code>getStudentCount</code>, <code>getUserName</code> - Use
<code>is</code>/<code>has</code> prefix for boolean methods:
<code>isValid</code>, <code>hasPermission</code> - Be specific: prefer
<code>calculateNetPrice</code> over <code>calculate</code></p>
<hr />
<h3 id="add-parameter-and-remove-parameter">Add Parameter and Remove
Parameter</h3>
<p><strong>When to Use</strong>: - <strong>Add Parameter</strong>: A
method needs more information from its caller - <strong>Remove
Parameter</strong>: A parameter is no longer used by the method body</p>
<p><strong>Goal</strong>: Keep method signatures lean and only include
necessary parameters.</p>
<p><strong>Important</strong>: Don’t add a parameter if the information
can be obtained from another existing parameter or from an instance
variable.</p>
<p><strong>Example</strong>:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating Add Parameter and Remove Parameter refactoring</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Adjusting method signatures to match actual needs</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Scenario 1: REMOVE Parameter - parameter no longer needed</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EmailServiceBefore <span class="op">{</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">companyName</span> <span class="op">=</span> <span class="st">&quot;TechCorp&quot;</span>  <span class="co">// Instance variable</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// The companyName parameter is redundant!</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">sendWelcomeEmail</span><span class="op">(</span><span class="va">userEmail</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">userName</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">companyName</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Sending to: </span><span class="ss">$userEmail</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Dear </span><span class="ss">$userName</span><span class="st">,&quot;</span><span class="op">)</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Welcome to </span><span class="ss">$companyName</span><span class="st">!&quot;</span><span class="op">)</span>  <span class="co">// Uses parameter instead of field</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;---&quot;</span><span class="op">)</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EmailServiceAfter <span class="op">{</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">companyName</span> <span class="op">=</span> <span class="st">&quot;TechCorp&quot;</span>  <span class="co">// Instance variable</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Removed redundant parameter - uses instance variable instead</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">sendWelcomeEmail</span><span class="op">(</span><span class="va">userEmail</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span> <span class="va">userName</span><span class="op">:</span> <span class="dt">String</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Sending to: </span><span class="ss">$userEmail</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Dear </span><span class="ss">$userName</span><span class="st">,&quot;</span><span class="op">)</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;Welcome to </span><span class="ss">$companyName</span><span class="st">!&quot;</span><span class="op">)</span>  <span class="co">// Uses instance variable</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;---&quot;</span><span class="op">)</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co">// Scenario 2: ADD Parameter - method needs more information</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> InvoiceGeneratorBefore <span class="op">{</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Missing important information - no way to specify currency!</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">generateInvoice</span><span class="op">(</span><span class="va">amount</span><span class="op">:</span> <span class="dt">Double</span><span class="op">,</span> <span class="va">customerName</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="st">            Invoice</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="st">            Customer: </span><span class="ss">$customerName</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="st">            Amount: </span><span class="ss">$amount</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;&quot;&quot;</span><span class="op">.</span>trimIndent<span class="op">()</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> InvoiceGeneratorAfter <span class="op">{</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Added currency parameter - now we have the needed information</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">generateInvoice</span><span class="op">(</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>        <span class="va">amount</span><span class="op">:</span> <span class="dt">Double</span><span class="op">,</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>        <span class="va">customerName</span><span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>        <span class="va">currency</span><span class="op">:</span> <span class="dt">String</span> <span class="op">=</span> <span class="st">&quot;GBP&quot;</span>  <span class="co">// Default value for convenience</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">):</span> <span class="dt">String</span> <span class="op">{</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">symbol</span> <span class="op">=</span> <span class="cf">when</span> <span class="op">(</span>currency<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;GBP&quot;</span> <span class="op">-&gt;</span> <span class="st">&quot;£&quot;</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;USD&quot;</span> <span class="op">-&gt;</span> <span class="st">&quot;</span><span class="ss">$</span><span class="st">&quot;</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;EUR&quot;</span> <span class="op">-&gt;</span> <span class="st">&quot;€&quot;</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="op">-&gt;</span> currency</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> <span class="st">&quot;&quot;&quot;</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a><span class="st">            Invoice</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="st">            Customer: </span><span class="ss">$customerName</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a><span class="st">            Amount: </span><span class="ss">$symbol${</span><span class="st">&quot;%.2f&quot;</span><span class="op">.</span>format<span class="op">(</span>amount<span class="op">)</span><span class="ss">}</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a><span class="st">        &quot;&quot;&quot;</span><span class="op">.</span>trimIndent<span class="op">()</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== REMOVE Parameter Example ===&quot;</span><span class="op">)</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;BEFORE: Redundant parameter&quot;</span><span class="op">)</span></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">emailBefore</span> <span class="op">=</span> EmailServiceBefore<span class="op">()</span></span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>    emailBefore<span class="op">.</span>sendWelcomeEmail<span class="op">(</span><span class="st">&quot;alice@email.com&quot;</span><span class="op">,</span> <span class="st">&quot;Alice&quot;</span><span class="op">,</span> <span class="st">&quot;TechCorp&quot;</span><span class="op">)</span></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">AFTER: Parameter removed&quot;</span><span class="op">)</span></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">emailAfter</span> <span class="op">=</span> EmailServiceAfter<span class="op">()</span></span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>    emailAfter<span class="op">.</span>sendWelcomeEmail<span class="op">(</span><span class="st">&quot;alice@email.com&quot;</span><span class="op">,</span> <span class="st">&quot;Alice&quot;</span><span class="op">)</span></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== ADD Parameter Example ===&quot;</span><span class="op">)</span></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;BEFORE: Missing currency information&quot;</span><span class="op">)</span></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">invoiceBefore</span> <span class="op">=</span> InvoiceGeneratorBefore<span class="op">()</span></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>invoiceBefore<span class="op">.</span>generateInvoice<span class="op">(</span><span class="fl">1000.00</span><span class="op">,</span> <span class="st">&quot;Bob Smith&quot;</span><span class="op">))</span></span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">AFTER: Currency parameter added&quot;</span><span class="op">)</span></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">invoiceAfter</span> <span class="op">=</span> InvoiceGeneratorAfter<span class="op">()</span></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>invoiceAfter<span class="op">.</span>generateInvoice<span class="op">(</span><span class="fl">1000.00</span><span class="op">,</span> <span class="st">&quot;Bob Smith&quot;</span><span class="op">,</span> <span class="st">&quot;USD&quot;</span><span class="op">))</span></span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>    println<span class="op">()</span></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>invoiceAfter<span class="op">.</span>generateInvoice<span class="op">(</span><span class="fl">1500.00</span><span class="op">,</span> <span class="st">&quot;Charlie Brown&quot;</span><span class="op">))</span>  <span class="co">// Uses default GBP</span></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== REMOVE Parameter Example ===
BEFORE: Redundant parameter
Sending to: alice@email.com
Dear Alice,
Welcome to TechCorp!
---

AFTER: Parameter removed
Sending to: alice@email.com
Dear Alice,
Welcome to TechCorp!
---

=== ADD Parameter Example ===
BEFORE: Missing currency information
Invoice
Customer: Bob Smith
Amount: 1000.0

AFTER: Currency parameter added
Invoice
Customer: Bob Smith
Amount: $1000.00

Invoice
Customer: Charlie Brown
Amount: £1500.00</code></pre>
<p><strong>Guidelines for Parameters</strong>: - <strong>Remove</strong>
if: parameter is never used, or can be derived from existing parameters,
or is already an instance variable - <strong>Add</strong> if: method
needs information it doesn’t have access to, but first check if it
should be an instance variable instead - Keep parameter lists short
(ideally 3 or fewer) - Consider using a data class for methods with many
parameters</p>
<hr />
<h2 id="unit-testing-and-refactoring">Unit Testing and Refactoring</h2>
<h3 id="the-relationship-between-testing-and-refactoring">The
Relationship Between Testing and Refactoring</h3>
<p>Unit testing and refactoring work hand-in-hand to ensure code
quality:</p>
<p><strong>Key Principles</strong>: 1. <strong>Tests enable safe
refactoring</strong>: With a comprehensive test suite, you can refactor
confidently knowing that if you break something, the tests will catch it
2. <strong>Refactor to make code testable</strong>: Sometimes code
smells make testing difficult, and refactoring improves testability 3.
<strong>Tests may need updating</strong>: When you refactor method
signatures or extract classes, you may need to modify or create new
tests</p>
<h3 id="the-refactoring-workflow">The Refactoring Workflow</h3>
<pre><code>┌─────────────────┐
│  Write Tests    │
│  (if needed)    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   Run Tests     │
│  (all pass)     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   Refactor      │
│    Code         │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   Run Tests     │
│   Again         │
└────────┬────────┘
         │
    ┌────┴─────┐
    │          │
    ▼          ▼
┌───────┐  ┌──────┐
│ Pass  │  │ Fail │
│ ✓     │  │  ✗   │
└───┬───┘  └──┬───┘
    │         │
    │         ▼
    │    ┌────────────┐
    │    │ Fix Code   │
    │    │ or Tests   │
    │    └─────┬──────┘
    │          │
    └──────────┘</code></pre>
<h3 id="example-with-unit-tests">Example with Unit Tests</h3>
<div class="sourceCode" id="cb36"><pre
class="sourceCode kotlin"><code class="sourceCode kotlin"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Example demonstrating refactoring with unit tests</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * Shows how tests ensure refactoring doesn&#39;t break functionality</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Original implementation with code smell (long method)</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PasswordValidatorOriginal <span class="op">{</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">validatePassword</span><span class="op">(</span><span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Pair</span><span class="op">&lt;</span><span class="dt">Boolean</span>, <span class="dt">String</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Long method with multiple responsibilities</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>password<span class="op">.</span>length <span class="op">&lt;</span> <span class="dv">8</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">false</span><span class="op">,</span> <span class="st">&quot;Password must be at least 8 characters&quot;</span><span class="op">)</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> <span class="va">hasUpper</span> <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> <span class="va">hasLower</span> <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> <span class="va">hasDigit</span> <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>char <span class="kw">in</span> password<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>char<span class="op">.</span>isUpperCase<span class="op">())</span> hasUpper <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>char<span class="op">.</span>isLowerCase<span class="op">())</span> hasLower <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>char<span class="op">.</span>isDigit<span class="op">())</span> hasDigit <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>hasUpper<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">false</span><span class="op">,</span> <span class="st">&quot;Password must contain uppercase letter&quot;</span><span class="op">)</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>hasLower<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">false</span><span class="op">,</span> <span class="st">&quot;Password must contain lowercase letter&quot;</span><span class="op">)</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>hasDigit<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">false</span><span class="op">,</span> <span class="st">&quot;Password must contain digit&quot;</span><span class="op">)</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Password is valid&quot;</span><span class="op">)</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="co">// Refactored implementation using Extract Method</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PasswordValidatorRefactored <span class="op">{</span></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">validatePassword</span><span class="op">(</span><span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Pair</span><span class="op">&lt;</span><span class="dt">Boolean</span>, <span class="dt">String</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Much cleaner - each validation is extracted</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>hasMinimumLength<span class="op">(</span>password<span class="op">))</span> <span class="op">{</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">false</span><span class="op">,</span> <span class="st">&quot;Password must be at least 8 characters&quot;</span><span class="op">)</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>hasUpperCase<span class="op">(</span>password<span class="op">))</span> <span class="op">{</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">false</span><span class="op">,</span> <span class="st">&quot;Password must contain uppercase letter&quot;</span><span class="op">)</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>hasLowerCase<span class="op">(</span>password<span class="op">))</span> <span class="op">{</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">false</span><span class="op">,</span> <span class="st">&quot;Password must contain lowercase letter&quot;</span><span class="op">)</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>hasDigit<span class="op">(</span>password<span class="op">))</span> <span class="op">{</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>            <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">false</span><span class="op">,</span> <span class="st">&quot;Password must contain digit&quot;</span><span class="op">)</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> Pair<span class="op">(</span><span class="kw">true</span><span class="op">,</span> <span class="st">&quot;Password is valid&quot;</span><span class="op">)</span></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Extracted methods - easier to test and understand</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">hasMinimumLength</span><span class="op">(</span><span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> password<span class="op">.</span>length <span class="op">&gt;=</span> <span class="dv">8</span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">hasUpperCase</span><span class="op">(</span><span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> password<span class="op">.</span>any <span class="op">{</span> it<span class="op">.</span>isUpperCase<span class="op">()</span> <span class="op">}</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">hasLowerCase</span><span class="op">(</span><span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> password<span class="op">.</span>any <span class="op">{</span> it<span class="op">.</span>isLowerCase<span class="op">()</span> <span class="op">}</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">hasDigit</span><span class="op">(</span><span class="va">password</span><span class="op">:</span> <span class="dt">String</span><span class="op">):</span> <span class="dt">Boolean</span> <span class="op">{</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> password<span class="op">.</span>any <span class="op">{</span> it<span class="op">.</span>isDigit<span class="op">()</span> <span class="op">}</span></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a><span class="co">// Simple test runner</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> PasswordValidatorTests <span class="op">{</span></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">runAllTests</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;=== Running Tests ===</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a>        testValidPassword<span class="op">()</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>        testTooShort<span class="op">()</span></span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>        testNoUpperCase<span class="op">()</span></span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>        testNoLowerCase<span class="op">()</span></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>        testNoDigit<span class="op">()</span></span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">✓ All tests passed!&quot;</span><span class="op">)</span></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">testValidPassword</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">validator</span> <span class="op">=</span> PasswordValidatorRefactored<span class="op">()</span></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">result</span> <span class="op">=</span> validator<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;Password123&quot;</span><span class="op">)</span></span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a>        assert<span class="op">(</span>result<span class="op">.</span>first<span class="op">)</span> <span class="op">{</span> <span class="st">&quot;Test failed: Valid password rejected&quot;</span> <span class="op">}</span></span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;✓ Test passed: Valid password accepted&quot;</span><span class="op">)</span></span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">testTooShort</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">validator</span> <span class="op">=</span> PasswordValidatorRefactored<span class="op">()</span></span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">result</span> <span class="op">=</span> validator<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;Pass1&quot;</span><span class="op">)</span></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>        assert<span class="op">(!</span>result<span class="op">.</span>first<span class="op">)</span> <span class="op">{</span> <span class="st">&quot;Test failed: Short password accepted&quot;</span> <span class="op">}</span></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>        assert<span class="op">(</span>result<span class="op">.</span>second<span class="op">.</span>contains<span class="op">(</span><span class="st">&quot;8 characters&quot;</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Test failed: Wrong error message&quot;</span></span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;✓ Test passed: Short password rejected&quot;</span><span class="op">)</span></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">testNoUpperCase</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">validator</span> <span class="op">=</span> PasswordValidatorRefactored<span class="op">()</span></span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">result</span> <span class="op">=</span> validator<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;password123&quot;</span><span class="op">)</span></span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>        assert<span class="op">(!</span>result<span class="op">.</span>first<span class="op">)</span> <span class="op">{</span> <span class="st">&quot;Test failed: Password without uppercase accepted&quot;</span> <span class="op">}</span></span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;✓ Test passed: No uppercase rejected&quot;</span><span class="op">)</span></span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">testNoLowerCase</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">validator</span> <span class="op">=</span> PasswordValidatorRefactored<span class="op">()</span></span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">result</span> <span class="op">=</span> validator<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;PASSWORD123&quot;</span><span class="op">)</span></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a>        assert<span class="op">(!</span>result<span class="op">.</span>first<span class="op">)</span> <span class="op">{</span> <span class="st">&quot;Test failed: Password without lowercase accepted&quot;</span> <span class="op">}</span></span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;✓ Test passed: No lowercase rejected&quot;</span><span class="op">)</span></span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">fun</span> <span class="fu">testNoDigit</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">validator</span> <span class="op">=</span> PasswordValidatorRefactored<span class="op">()</span></span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">result</span> <span class="op">=</span> validator<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;Password&quot;</span><span class="op">)</span></span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a>        assert<span class="op">(!</span>result<span class="op">.</span>first<span class="op">)</span> <span class="op">{</span> <span class="st">&quot;Test failed: Password without digit accepted&quot;</span> <span class="op">}</span></span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a>        println<span class="op">(</span><span class="st">&quot;✓ Test passed: No digit rejected&quot;</span><span class="op">)</span></span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Demonstrate that both implementations work the same</span></span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;=== Original Implementation ===&quot;</span><span class="op">)</span></span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">original</span> <span class="op">=</span> PasswordValidatorOriginal<span class="op">()</span></span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>original<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;Password123&quot;</span><span class="op">))</span></span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>original<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;pass&quot;</span><span class="op">))</span></span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== Refactored Implementation ===&quot;</span><span class="op">)</span></span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">refactored</span> <span class="op">=</span> PasswordValidatorRefactored<span class="op">()</span></span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>refactored<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;Password123&quot;</span><span class="op">))</span></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a>    println<span class="op">(</span>refactored<span class="op">.</span>validatePassword<span class="op">(</span><span class="st">&quot;pass&quot;</span><span class="op">))</span></span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Run tests to prove refactoring preserved behavior</span></span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a>    println<span class="op">()</span></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">tests</span> <span class="op">=</span> PasswordValidatorTests<span class="op">()</span></span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a>    tests<span class="op">.</span>runAllTests<span class="op">()</span></span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Sample Output</strong>:</p>
<pre><code>=== Original Implementation ===
(true, Password is valid)
(false, Password must be at least 8 characters)

=== Refactored Implementation ===
(true, Password is valid)
(false, Password must be at least 8 characters)

=== Running Tests ===

✓ Test passed: Valid password accepted
✓ Test passed: Short password rejected
✓ Test passed: No uppercase rejected
✓ Test passed: No lowercase rejected
✓ Test passed: No digit rejected

✓ All tests passed!</code></pre>
<h3 id="when-tests-need-to-change">When Tests Need to Change</h3>
<p>Sometimes refactoring requires updating tests:</p>
<ol type="1">
<li><strong>Method signature changes</strong> (Add/Remove Parameter):
Update test calls</li>
<li><strong>Extract Class</strong>: Create tests for the new class</li>
<li><strong>Hide Method</strong>: Remove tests for now-private methods
(or test through public interface)</li>
<li><strong>Encapsulate Collection</strong>: Update tests that directly
manipulated collections</li>
</ol>
<p><strong>Important</strong>: If refactoring breaks many tests, it
might indicate the refactoring is too large. Consider smaller,
incremental steps.</p>
<hr />
<h2 id="summary-and-best-practices">Summary and Best Practices</h2>
<h3 id="key-takeaways">Key Takeaways</h3>
<ol type="1">
<li><strong>Code Smells Are Warning Signs</strong>
<ul>
<li>They indicate potential design problems</li>
<li>Not bugs, but maintenance risks</li>
<li>Address them before they become serious issues</li>
</ul></li>
<li><strong>Refactoring Improves Internal Structure</strong>
<ul>
<li>Changes how code works, not what it does</li>
<li>Should be done in small, safe steps</li>
<li>Always preserve external behavior</li>
</ul></li>
<li><strong>Common Refactoring Patterns</strong>
<ul>
<li>Extract Method: Break down long methods</li>
<li>Encapsulation: Protect data with controlled access</li>
<li>Type Safety: Replace magic numbers with enums</li>
<li>Simplification: Remove unnecessary complexity</li>
</ul></li>
<li><strong>Testing Enables Safe Refactoring</strong>
<ul>
<li>Write tests before refactoring when possible</li>
<li>Run tests after each refactoring step</li>
<li>Tests document expected behavior</li>
</ul></li>
</ol>
<h3 id="when-to-refactor">When to Refactor</h3>
<p><strong>Good Times to Refactor</strong>: - When adding a new feature
(refactor to make room) - When fixing a bug (refactor to prevent
recurrence) - During code review (refactor based on feedback) - When you
notice a code smell (refactor immediately if time permits)</p>
<p><strong>When NOT to Refactor</strong>: - When code works and doesn’t
need to change - When you’re close to a deadline (unless absolutely
necessary) - When you don’t have tests and can’t write them easily -
When rewriting would be faster than refactoring</p>
<h3 id="the-boy-scout-rule">The Boy Scout Rule</h3>
<blockquote>
<p>“Leave the code cleaner than you found it.”</p>
</blockquote>
<p>Every time you touch code: - Fix one small thing - Extract one method
- Rename one variable - Add one comment</p>
<p>Small improvements compound over time!</p>
<h3 id="final-thoughts">Final Thoughts</h3>
<p>Refactoring is not a luxury—it’s essential for long-term project
health. Code quality matters because: - <strong>Developers spend more
time reading code than writing it</strong> - <strong>Clean code has
fewer bugs</strong> - <strong>Maintainable code saves money</strong> -
<strong>Good code is professional code</strong></p>
<p>Remember: Perfect code doesn’t exist, but continuously improved code
does. Embrace refactoring as an ongoing practice, not a one-time
event.</p>
<p><strong>Resources for Further Learning</strong>: - Fowler, M. (1999).
<em>Refactoring: Improving the Design of Existing Code</em> - Martin, R.
C. (2008). <em>Clean Code: A Handbook of Agile Software
Craftsmanship</em> - Kotlin official documentation on best practices -
IntelliJ IDEA refactoring tools (Ctrl+Alt+Shift+T for refactoring
menu)</p>
<hr />
<p><strong>End of Lecture</strong></p>
